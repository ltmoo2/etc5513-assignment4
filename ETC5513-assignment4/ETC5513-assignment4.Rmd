---
title: "ETC5513-Assignment4"
author:
- familyname: 
  othernames: 
  address: Monash University
  email: 
  correspondingauthor: true
  qualifications:
- familyname: 
  othernames: 
  address: Monash University
  email: 
  correspondingauthor: true
  qualifications:
- familyname: 
  othernames: 
  address: Monash University
  email: 
  correspondingauthor: true
  qualifications:
- familyname: 
  othernames: 
  address: Monash University
  email: 
  correspondingauthor: true
  qualifications:
department: Department of\newline Econometrics &\newline Business Statistics
organization: Acme Corporation
bibliography: references.bib
biblio-style: authoryear-comp
linestretch: 1.5
output:
  MonashEBSTemplates::report:
    fig_caption: yes
    fig_height: 5
    fig_width: 8
    includes:
      in_header: preamble.tex
    keep_tex: yes
    number_sections: yes
    citation_package: biblatex
    toc: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, cache=TRUE, messages=FALSE, warning=FALSE, fig.pos = 'H')

library(tidyverse)
library(ggplot2)
library(kableExtra)
library(here)
library(gganimate)
```


```{r readingdata, message = FALSE, warning = FALSE}
expectancy <- read_csv(here::here("data", "life_expectancy.csv"))
names(expectancy) <- paste(names(expectancy), expectancy[1, ], sep = "_") ## Merging first two header rows together to get row names
expectancy <- expectancy[-1,] ## Removing now unnecessary firt row

spend <- read_csv(here::here("data", "health_expenditure.csv"), skip = 1)

gdp <- read_csv(here::here("data", "gdp_data.csv"), skip = 3)

head(expectancy,10)

head(spend, 10)
head(gdp, 10)
```

 
\section*{Introduction}



\section*{Differences between men and women}



\section*{Differences betweetn countries}



\section*{Life expectancy at birth vs at 60}



\section*{Life expectancy and Gross Domestic Product}
Life expectancy and GDP in USA
- What to do?
Is there any relation between life span and GDP? Very hard to say, it is basically chicken and egg. Students with better health will study faster as they can stay at school more. Likewise, healthier person save more and thus contribute more to the economy. (They can work harder, longer and focus more on the task) [6] (https://en.wikipedia.org/wiki/Preston_curve)
Therefore, I will only create the graph, inspired by [this link](https://vimeo.com/113449763)
What is in the video:
geom_point x = lifespan, y = Income, color = continent, size = population) 

```{r}

T_expectancy_tidy <- expectancy %>%
      rename(life_exp = "Life expectancy at birth (years)_Both sexes",
             country = X1_Country,
             year = X2_Year) %>%
      select(country, year, life_exp) %>%
      filter(year == "2016")

T_gdp_tidy <- gdp %>%
      select(`Country Name`, "2016")%>%
      na.omit()
T_gdp_and_span <- left_join(T_expectancy_tidy, T_gdp_tidy, by = c("country" = "Country Name"))

T_population <- read_csv(here::here("data/Population_data.csv"))
  
T_continent <-read_csv("https://raw.githubusercontent.com/dbouquin/IS_608/master/NanosatDB_munging/Countries-Continents.csv")

T_tidy <- left_join(T_gdp_and_span, T_continent, by = c("country" = "Country"))

```


```{r}
T_population <- read_csv(here::here("data/Population_data.csv"), skip = 3) %>%
    select(`Country Name`, "2016") %>%
    rename(population = "2016")
T_continent <-read_csv("https://raw.githubusercontent.com/dbouquin/IS_608/master/NanosatDB_munging/Countries-Continents.csv")

T_expectancy_tidy1 <- expectancy %>%
    rename(life_exp = "Life expectancy at birth (years)_Both sexes",
    country = X1_Country,
    year = X2_Year) %>%
    filter(year == "2016") %>%
    select(country, life_exp)

T_expectancy_tidy2 <- T_expectancy_tidy1 %>% 
  mutate(country = str_replace_all(country,
                        c("Bolivia" = "Bolivia (Plurinational State of)",
                   "United Kingdom" = "United Kingdom of Great Britain and Northern Ireland",
                          "Moldova" = "Republic of Moldova",
                          "Tanzania" = "United Republic of Tanzania",
                          "Vietnam" = "Viet Nam"))
)
T_gdp_tidy <- gdp %>%
    select(`Country Name`, "2016") %>%
    rename(GDP = "2016")
T_tidy <-  left_join(T_gdp_tidy, T_population) %>%
    left_join(T_continent, by = c("Country Name" = "Country")) %>%
    na.omit()
T_tidy2 <- left_join(T_tidy, T_expectancy_tidy2, by = c("Country Name" = "country"))
T_plot <- T_tidy2 %>% mutate(life_exp = as.numeric(life_exp))
    ggplot (T_plot, aes(x = GDP, y = life_exp, color = Continent, size = population)) +
    geom_point()

```

```{r}
plot1 <- ggplot(T_plot, 
            aes(x = GDP, y=life_exp, 
                size = population,
                colour = Continent)) +
  geom_point(alpha = 0.6, 
             na.rm = TRUE) +
  scale_color_brewer(palette = "Set2")+
  scale_size(range = c(1, 4)) + 
  transition_time(Year)
  #scale_x_continuous(limits = c(0,10000), breaks = 1000)+
  labs(title = 'Year: {frame_time}', 
       x = "Health expenditure per capita(US$)", 
       y = "Life expectancy at birth(years)") +
  ease_aes()+
  theme_bw()

plot1
```